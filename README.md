# Supplementary Materials – Field Experiment on Multiple Stressors in Estuarine Biofilms

This repository accompanies the manuscript titled **“[Insert Title Here]”**, which reports on a manipulative field experiment investigating the independent and combined effects of glyphosate and titanium dioxide nanoparticles (TiO₂ NP) on estuarine microphytobenthic biofilms. The study focuses on both structural (e.g. chlorophyll *a*) and functional (e.g. EPS production, erosion resistance) responses, with repeated measurements taken across experimental time points.

The repository provides all data and R scripts used for statistical modelling and reproducibility. It is intended to support peer review, reproducibility, and future reuse of the analytical workflow.

---

## Repository contents

### `data/`
- `contact_core_data.txt`  
  Processed data file containing chlorophyll *a*, EPS, and related measurements from individual sediment cores.  
  See `data/README_data.md` for variable definitions and structure.  
  *(Additional data files may be added as further analyses are incorporated.)*

### `scripts/`
- `eps_models.R`  
  Bayesian hierarchical models of colloidal carbohydrate (EPS proxy) concentrations before and after stressor exposure, including adjusted differences and interaction effects.

- `chlorophyll_models.R`  
  Bayesian hierarchical models of chlorophyll *a* concentrations, including full treatment effects, covariate inclusion, and model comparison using leave-one-out cross-validation (LOO).

*(More scripts will be added as modelling proceeds for additional endpoints.)*

---

## Requirements

Scripts are written in **R** (version ≥ 4.1.0) and require the following packages:

- `rstanarm`  
- `shinystan`  
- `bayestestR`  
- `bayesplot`  
- `loo`  
- `tidyverse`  
- `plyr`  
- `here`  
- `lme4`

All file paths are handled using the `here()` package for portability and compatibility with relative file structures.

---

## Reproducibility notes

- All models are fitted using `stan_lmer()` from the `rstanarm` package with explicitly defined weakly regularising priors.
- Model outputs and comparisons can be regenerated by running each script from start to finish.
- Spurious measurements were removed prior to analysis, as described in the manuscript and reflected in the processed dataset.
- Leave-one-out cross-validation (LOO) is used for model comparison. The `k_threshold = 0.7` argument enables automatic refitting where necessary.

---

*For any questions regarding this repository, please contact [Your Name / Corresponding Author's Email].*
